<!-- templates/base.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Prompt Battle Playground{% endblock %}</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="/">Prompt Battle Playground</a>
        </div>
    </nav>
    
    <div class="container mt-4">
        {% block content %}{% endblock %}
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    {% block scripts %}{% endblock %}
</body>
</html>

<!-- templates/index.html -->
{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h3 class="text-center">Welcome to Prompt Battle Playground</h3>
            </div>
            <div class="card-body text-center">
                <p>Choose your login type:</p>
                <a href="/login" class="btn btn-primary btn-lg me-3">Login</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

<!-- templates/login.html -->
{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <ul class="nav nav-tabs card-header-tabs" id="loginTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="admin-tab" data-bs-toggle="tab" data-bs-target="#admin" type="button" role="tab">Admin Login</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="player-tab" data-bs-toggle="tab" data-bs-target="#player" type="button" role="tab">Player Login</button>
                    </li>
                </ul>
            </div>
            <div class="card-body">
                <div class="tab-content" id="loginTabContent">
                    <!-- Admin Login -->
                    <div class="tab-pane fade show active" id="admin" role="tabpanel">
                        <form id="adminLoginForm">
                            <div class="mb-3">
                                <label for="adminEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="adminEmail" required>
                            </div>
                            <div class="mb-3">
                                <label for="adminPassword" class="form-label">Password</label>
                                <input type="password" class="form-control" id="adminPassword" required>
                            </div>
                            <button type="submit" class="btn btn-primary w-100">Admin Login</button>
                        </form>
                    </div>
                    
                    <!-- Player Login -->
                    <div class="tab-pane fade" id="player" role="tabpanel">
                        <form id="playerLoginForm">
                            <div class="mb-3">
                                <label for="playerEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="playerEmail" required>
                            </div>
                            <div class="mb-3">
                                <label for="playerPassword" class="form-label">Password (Phone Number)</label>
                                <input type="password" class="form-control" id="playerPassword" required>
                            </div>
                            <button type="submit" class="btn btn-success w-100">Player Login</button>
                        </form>
                    </div>
                </div>
                
                <div id="loginMessage" class="mt-3"></div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const email = document.getElementById('adminEmail').value;
    const password = document.getElementById('adminPassword').value;
    
    fetch('/admin-login', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({email: email, password: password})
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            window.location.href = data.redirect;
        } else {
            document.getElementById('loginMessage').innerHTML = 
                '<div class="alert alert-danger">' + data.message + '</div>';
        }
    });
});

document.getElementById('playerLoginForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const email = document.getElementById('playerEmail').value;
    const password = document.getElementById('playerPassword').value;
    
    fetch('/player-login', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({email: email, password: password})
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            window.location.href = data.redirect;
        } else {
            document.getElementById('loginMessage').innerHTML = 
                '<div class="alert alert-danger">' + data.message + '</div>';
        }
    });
});
</script>
{% endblock %}

<!-- templates/admin_dashboard.html -->
{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <h2>Admin Dashboard</h2>
        
        <!-- Tabs for different admin functions -->
        <ul class="nav nav-tabs" id="adminTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="users-tab" data-bs-toggle="tab" data-bs-target="#users" type="button" role="tab">Users</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="questions-tab" data-bs-toggle="tab" data-bs-target="#questions" type="button" role="tab">Questions</button>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" href="/playground">Playground</a>
            </li>
        </ul>
        
        <div class="tab-content mt-3" id="adminTabContent">
            <!-- Users Tab -->
            <div class="tab-pane fade show active" id="users" role="tabpanel">
                <div class="row mb-3">
                    <div class="col-md-12">
                        <button class="btn btn-primary" onclick="importUsers()">Import Users from CSV</button>
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Full Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Technical</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable">
                            {% for user in users %}
                            <tr>
                                <td>{{ user.user_id }}</td>
                                <td>{{ user.fullname }}</td>
                                <td>{{ user.emailid }}</td>
                                <td>{{ user.phonenumber }}</td>
                                <td>{{ 'Yes' if user.is_technical else 'No' }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Questions Tab -->
            <div class="tab-pane fade" id="questions" role="tabpanel">
                <div class="row mb-3">
                    <div class="col-md-8">
                        <textarea class="form-control" id="newQuestion" placeholder="Enter new question" rows="3"></textarea>
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-success" onclick="addQuestion()">Add Question</button>
                    </div>
                </div>
                
                <div class="list-group" id="questionsList">
                    {% for question in questions %}
                    <div class="list-group-item">
                        <h6>{{ question.text }}</h6>
                        <small class="text-muted">Created: {{ question.created_at }}</small>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<div id="messageArea"></div>
{% endblock %}

{% block scripts %}
<script>
function importUsers() {
    fetch('/import-users', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        }
    })
    .then(response => response.json())
    .then(data => {
        showMessage(data.message, data.success ? 'success' : 'danger');
        if (data.success) {
            location.reload();
        }
    });
}

function addQuestion() {
    const questionText = document.getElementById('newQuestion').value;
    
    if (!questionText.trim()) {
        showMessage('Please enter a question', 'warning');
        return;
    }
    
    fetch('/add-question', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({question: questionText})
    })
    .then(response => response.json())
    .then(data => {
        showMessage(data.message || 'Question added successfully', data.success ? 'success' : 'danger');
        if (data.success) {
            document.getElementById('newQuestion').value = '';
            location.reload();
        }
    });
}

function showMessage(message, type) {
    const messageArea = document.getElementById('messageArea');
    messageArea.innerHTML = `<div class="alert alert-${type} mt-3">${message}</div>`;
    setTimeout(() => {
        messageArea.innerHTML = '';
    }, 3000);
}
</script>
{% endblock %}

<!-- templates/playground.html -->
{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <h2>Prompt Battle Playground</h2>
        
        <!-- Timer Display -->
        <div class="text-center mb-4">
            <h3 id="timer" class="text-primary">00:00</h3>
        </div>
        
        <!-- Admin Controls (only visible to admin) -->
        {% if user_type == 'admin' %}
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>Admin Controls</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <label for="timerMinutes">Timer (MM:SS)</label>
                                <div class="input-group">
                                    <input type="number" class="form-control" id="timerMinutes" placeholder="MM" min="0" max="59" value="5">
                                    <span class="input-group-text">:</span>
                                    <input type="number" class="form-control" id="timerSeconds" placeholder="SS" min="0" max="59" value="0">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label for="playerCount">Number of Players</label>
                                <select class="form-control" id="playerCount">
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label>Select Players</label>
                                <div id="playersList"></div>
                            </div>
                            <div class="col-md-3">
                                <label>Select Question</label>
                                <div id="questionsList"></div>
                            </div>
                        </div>
                        
                        <div class="row mt-3">
                            <div class="col-md-12">
                                <button class="btn btn-primary me-2" onclick="setQuestion()">Set Question</button>
                                <button class="btn btn-success me-2" onclick="startGame()">Start</button>
                                <button class="btn btn-warning me-2" onclick="stopGame()">Stop</button>
                                